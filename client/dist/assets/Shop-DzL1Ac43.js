import{r as s,u as P,j as t,L as k}from"./index-yNFFM0-c.js";const f="https://beydecks-production.up.railway.app/api";function T(){const[l,h]=s.useState([]),[p,j]=s.useState(""),[o,v]=s.useState("All"),[i,N]=s.useState("All"),[d,y]=s.useState("All"),[a,n]=s.useState(1),m=12,x=sessionStorage.getItem("admin")==="true",u=P();s.useEffect(()=>{fetch(`${f}/products`).then(e=>e.json()).then(e=>{h(e.reverse())}).catch(e=>{console.error("❌ Failed to fetch products:",e)})},[]);const A=Array.from(new Set(l.flatMap(e=>e.listings.map(c=>c.country)))),S=Array.from(new Set(l.map(e=>e.brand).filter(Boolean))),w=Array.from(new Set(l.map(e=>e.productType).filter(Boolean))),g=l.filter(e=>e.title.toLowerCase().includes(p.toLowerCase())&&(o==="All"||e.listings.some(c=>c.country===o))&&(i==="All"||e.brand===i)&&(d==="All"||e.productType===d)),b=g.slice((a-1)*m,a*m),r=Math.ceil(g.length/m),C=async e=>{confirm("Are you sure you want to delete this product?")&&(await fetch(`${f}/products/${e}`,{method:"DELETE"}),h(l.filter(c=>c.id!==e)))};return t.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h1",{className:"text-3xl font-bold text-center w-full",children:"Shop"}),x&&t.jsx(k,{to:"/add-product",className:"btn btn-primary absolute right-6",children:"+ Add Product"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-center",children:[t.jsx("input",{type:"text",className:"input input-bordered w-full",placeholder:"Search products...",value:p,onChange:e=>j(e.target.value)}),t.jsxs("select",{className:"select select-bordered",value:o,onChange:e=>{v(e.target.value),n(1)},children:[t.jsx("option",{value:"All",children:"All Countries"}),A.map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsxs("select",{className:"select select-bordered",value:i,onChange:e=>{N(e.target.value),n(1)},children:[t.jsx("option",{value:"All",children:"All Brands"}),S.map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsxs("select",{className:"select select-bordered",value:d,onChange:e=>{y(e.target.value),n(1)},children:[t.jsx("option",{value:"All",children:"All Product Types"}),w.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),b.length===0?t.jsx("p",{className:"text-center text-sm text-gray-500",children:"No products found."}):t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:b.map(e=>t.jsxs("div",{className:"card bg-base-100 shadow p-4 flex flex-col",children:[t.jsx("img",{src:e.imageUrl||"/fallback.jpg",alt:e.title,className:"w-full h-48 object-contain cursor-pointer",onClick:()=>u(`/product/${e.id}`)}),t.jsx("div",{className:"mt-4 mb-2 min-h-[3.5rem]",children:t.jsx("h2",{className:"text-lg font-semibold text-center line-clamp-2",children:e.title})}),t.jsx("button",{className:"btn btn-outline btn-sm w-full mt-auto",onClick:()=>u(`/product/${e.id}`),children:"View Stores"}),x&&t.jsxs("div",{className:"flex gap-2 mt-2",children:[t.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>u(`/edit-product/${e.id}`),children:"Edit"}),t.jsx("button",{className:"btn btn-sm btn-error",onClick:()=>C(e.id),children:"Delete"})]})]},e.id))}),r>1&&t.jsxs("div",{className:"flex justify-center mt-6 gap-2 items-center",children:[t.jsx("button",{className:"btn btn-sm",onClick:()=>n(e=>Math.max(e-1,1)),disabled:a===1,children:"⬅️ Prev"}),t.jsxs("span",{className:"px-4 text-sm font-medium",children:["Page ",a," of ",r]}),t.jsx("button",{className:"btn btn-sm",onClick:()=>n(e=>Math.min(e+1,r)),disabled:a===r,children:"Next ➡️"})]})]})}export{T as default};
