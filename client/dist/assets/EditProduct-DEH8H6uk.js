import{a as S,u as T,r,j as s}from"./index-yNFFM0-c.js";const N="https://beydecks-production.up.railway.app/api";function U(){const{id:i}=S(),y=T(),[u,p]=r.useState(""),[c,m]=r.useState(""),[b,h]=r.useState(""),[g,x]=r.useState(""),[j,v]=r.useState(""),[o,l]=r.useState([]);r.useEffect(()=>{fetch(`${N}/products/${i}`).then(e=>e.json()).then(e=>{p(e.title),m(e.imageUrl),h(e.description),x(e.brand||""),v(e.productType||""),l(e.listings||[])}).catch(()=>alert("Failed to load product."))},[i]);const C=e=>new Promise((t,a)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=L=>a(L),n.readAsDataURL(e)}),w=async()=>{const e={title:u,imageUrl:c,description:b,brand:g,productType:j,listings:o};(await fetch(`${N}/products/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?y("/shop"):alert("Failed to update product.")},d=(e,t,a)=>{const n=[...o];n[e][t]=a,l(n)},P=()=>{l([...o,{storeName:"",buyLink:"",country:"Canada"}])},k=e=>{const t=[...o];t.splice(e,1),l(t)},f=(e,t)=>{if(t<0||t>=o.length)return;const a=[...o],[n]=a.splice(e,1);a.splice(t,0,n),l(a)};return s.jsxs("div",{className:"max-w-2xl mx-auto p-6 space-y-4",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Edit Product"}),s.jsx("input",{className:"input input-bordered w-full",placeholder:"Product Title",value:u,onChange:e=>p(e.target.value)}),c&&s.jsx("img",{src:c,alt:"Preview",className:"w-32 h-32 object-contain mt-2 border rounded"}),s.jsx("input",{type:"file",accept:"image/*",className:"file-input file-input-bordered w-full mt-2",onChange:async e=>{var a;const t=(a=e.target.files)==null?void 0:a[0];if(t){const n=await C(t);m(n)}}}),s.jsx("input",{className:"input input-bordered w-full",placeholder:"Brand",value:g,onChange:e=>x(e.target.value)}),s.jsx("input",{className:"input input-bordered w-full",placeholder:"Product Type",value:j,onChange:e=>v(e.target.value)}),s.jsx("textarea",{className:"textarea textarea-bordered w-full",placeholder:"Product Description",value:b,onChange:e=>h(e.target.value)}),s.jsx("h2",{className:"font-semibold",children:"Listings:"}),o.map((e,t)=>s.jsxs("div",{className:"grid grid-cols-3 gap-2 items-center mb-2",children:[s.jsx("input",{className:"input input-sm input-bordered",placeholder:"Store Name",value:e.storeName,onChange:a=>d(t,"storeName",a.target.value)}),s.jsx("input",{className:"input input-sm input-bordered",placeholder:"Buy Link",value:e.buyLink,onChange:a=>d(t,"buyLink",a.target.value)}),s.jsx("input",{className:"input input-sm input-bordered",placeholder:"Country",value:e.country,onChange:a=>d(t,"country",a.target.value)}),s.jsxs("div",{className:"flex gap-1 col-span-3 justify-end",children:[s.jsx("button",{className:"btn btn-xs btn-outline",disabled:t===0,onClick:()=>f(t,t-1),children:"â†‘"}),s.jsx("button",{className:"btn btn-xs btn-outline",disabled:t===o.length-1,onClick:()=>f(t,t+1),children:"â†“"}),s.jsx("button",{className:"btn btn-xs btn-error",onClick:()=>k(t),children:"ğŸ—‘ï¸"})]})]},t)),s.jsx("button",{className:"btn btn-outline btn-sm",onClick:P,children:"+ Add Store"}),s.jsx("div",{children:s.jsx("button",{className:"btn btn-success mt-4",onClick:w,children:"Save Changes"})})]})}export{U as default};
