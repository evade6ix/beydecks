import{d as y,u as j,r as o,j as t}from"./index-yNFFM0-c.js";const u="https://beydecks-production.up.railway.app/api";function S(){const{login:p}=y(),h=j(),[a,m]=o.useState(""),[c,f]=o.useState(""),[i,l]=o.useState(""),[g,n]=o.useState(null),w=async e=>{e.preventDefault(),l("");try{const s=await fetch(`${u}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:c})}),r=await s.json();if(!s.ok)return l(r.error||"Login failed");const d=r.token,x=g||await fetch(`${u}/auth/me`,{headers:{Authorization:`Bearer ${d}`}}).then(b=>b.json());p(d,x),h("/profile")}catch{l("Something went wrong.")}};return o.useEffect(()=>{if(!a){n(null);return}const e=setTimeout(async()=>{try{const s=await fetch(`${u}/auth/user/${encodeURIComponent(a)}`);if(s.ok){const r=await s.json();n(r)}else n(null)}catch{n(null)}},300);return()=>clearTimeout(e)},[a]),t.jsxs("form",{onSubmit:w,className:"p-6 max-w-md mx-auto space-y-4 text-white",children:[t.jsx("h2",{className:"text-2xl font-bold",children:"User Login"}),i&&t.jsx("p",{className:"text-red-500",children:i}),t.jsx("input",{type:"email",placeholder:"Email",className:"w-full p-2 border rounded bg-black",value:a,onChange:e=>m(e.target.value)}),t.jsx("input",{type:"password",placeholder:"Password",className:"w-full p-2 border rounded bg-black",value:c,onChange:e=>f(e.target.value)}),t.jsx("button",{className:"w-full bg-blue-600 text-white p-2 rounded",type:"submit",children:"Log In"})]})}export{S as default};
