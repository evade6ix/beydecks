import{r as n,j as t,L as M}from"./index-yNFFM0-c.js";import{S as h}from"./react-select.esm-B_SPqNnZ.js";import{m as V}from"./proxy-3_2GIcS0.js";const I="https://beydecks-production.up.railway.app/api";function J(){const[b,N]=n.useState([]),[g,L]=n.useState([]),[D,T]=n.useState([]),[i,E]=n.useState("All"),[c,P]=n.useState("All"),[k,F]=n.useState([]),[R,Y]=n.useState([]),[$,B]=n.useState([]),[r,O]=n.useState("All"),[m,p]=n.useState("All"),[d,A]=n.useState("All"),[y,j]=n.useState(1),w=9;n.useEffect(()=>{fetch(`${I}/events`).then(e=>e.json()).then(e=>{const o=e.filter(a=>new Date(a.endTime)<new Date);N(o);const l=Array.from(new Set(o.map(a=>a.store.trim()))).sort();T(["All",...l]);const s=Array.from(new Set(o.map(a=>{var v;return(v=a.country)==null?void 0:v.trim()}).filter(a=>!!a))).sort();F(["All",...s])})},[]),n.useEffect(()=>{const e=r==="All"?[]:b.filter(s=>{var a;return((a=s.country)==null?void 0:a.trim().toLowerCase())===r.toLowerCase()}),o=Array.from(new Set(e.map(s=>{var a;return(a=s.region)==null?void 0:a.trim()}).filter(s=>!!s))).sort(),l=Array.from(new Set(e.map(s=>{var a;return(a=s.city)==null?void 0:a.trim()}).filter(s=>!!s))).sort();Y(["All",...o]),B(["All",...l]),p("All"),A("All")},[r,b]),n.useEffect(()=>{let e=[...b];i!=="All"&&(e=e.filter(l=>l.store.trim().toLowerCase()===i.toLowerCase())),r!=="All"&&(e=e.filter(l=>{var s;return((s=l.country)==null?void 0:s.trim().toLowerCase())===r.toLowerCase()})),m!=="All"&&(e=e.filter(l=>{var s;return((s=l.region)==null?void 0:s.trim().toLowerCase())===m.toLowerCase()})),d!=="All"&&(e=e.filter(l=>{var s;return((s=l.city)==null?void 0:s.trim().toLowerCase())===d.toLowerCase()}));const o=new Date;if(c==="Last 30 Days"){const l=new Date;l.setDate(o.getDate()-30),e=e.filter(s=>new Date(s.endTime)>=l)}if(c==="This Year"){const l=new Date(o.getFullYear(),0,1);e=e.filter(s=>new Date(s.endTime)>=l)}e.sort((l,s)=>new Date(s.endTime).getTime()-new Date(l.endTime).getTime()),L(e),j(1)},[b,i,r,m,d,c]);const S=y*w,q=S-w,H=g.slice(q,S),C=Math.ceil(g.length/w),u=e=>e.map(o=>({label:o,value:o})),f=e=>({...e,colors:{...e.colors,neutral0:"#1f2937",neutral80:"#f9fafb",primary25:"#374151",primary:"#4f46e5"}}),x={control:e=>({...e,backgroundColor:"#1f2937",borderColor:"#374151",color:"#f9fafb"}),singleValue:e=>({...e,color:"#f9fafb"}),menu:e=>({...e,backgroundColor:"#1f2937",maxHeight:150,overflowY:"auto",scrollbarWidth:"thin",msOverflowStyle:"auto"}),menuList:e=>({...e,maxHeight:150,overflowY:"auto"}),option:(e,o)=>({...e,backgroundColor:o.isFocused?"#374151":"#1f2937",color:"#f9fafb",cursor:"pointer"})};return t.jsxs(V.div,{className:"p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[t.jsxs("h1",{className:"text-3xl font-bold mb-4",children:["Completed Events ",t.jsxs("span",{className:"text-sm font-normal text-gray-400",children:["(",g.length," total)"]})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[t.jsxs("div",{className:"w-64",children:[t.jsx("p",{className:"font-semibold mb-1",children:"Filter by Store:"}),t.jsx(h,{options:u(D),value:{label:i,value:i},onChange:e=>E((e==null?void 0:e.value)||"All"),theme:f,styles:x})]}),t.jsxs("div",{className:"w-64",children:[t.jsx("p",{className:"font-semibold mb-1",children:"Country:"}),t.jsx(h,{options:u(k),value:{label:r,value:r},onChange:e=>O((e==null?void 0:e.value)||"All"),theme:f,styles:x})]}),t.jsxs("div",{className:"w-64",children:[t.jsxs("p",{className:`font-semibold mb-1 ${r==="All"?"text-gray-400":""}`,children:["Province/State:",r==="All"&&t.jsx("span",{className:"text-xs ml-1 italic",children:"(select country first)"})]}),t.jsx(h,{options:u(R),value:{label:m,value:m},onChange:e=>p((e==null?void 0:e.value)||"All"),isDisabled:r==="All",theme:f,styles:x})]}),t.jsxs("div",{className:"w-64",children:[t.jsxs("p",{className:`font-semibold mb-1 ${r==="All"?"text-gray-400":""}`,children:["City:",r==="All"&&t.jsx("span",{className:"text-xs ml-1 italic",children:"(select country first)"})]}),t.jsx(h,{options:u($),value:{label:d,value:d},onChange:e=>A((e==null?void 0:e.value)||"All"),isDisabled:r==="All",theme:f,styles:x})]}),t.jsxs("div",{className:"w-64",children:[t.jsx("p",{className:"font-semibold mb-1",children:"Timeframe:"}),t.jsx(h,{options:u(["All","This Year","Last 30 Days"]),value:{label:c,value:c},onChange:e=>P((e==null?void 0:e.value)||"All"),theme:f,styles:x})]})]}),t.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:H.map(e=>t.jsx("div",{className:"card bg-base-200 shadow-md",children:t.jsxs("div",{className:"card-body",children:[t.jsx("h2",{className:"card-title",children:e.title}),t.jsx("p",{className:"text-sm",children:new Date(e.startTime).toLocaleDateString()}),t.jsxs("p",{className:"text-sm",children:["@ ",e.store]}),(e.city||e.region||e.country)&&t.jsxs("p",{className:"text-sm text-neutral-content",children:["ðŸ“ ",[e.city,e.region,e.country].filter(Boolean).join(", ")]}),e.attendeeCount!==void 0&&t.jsxs("p",{className:"text-sm text-neutral-content",children:[e.attendeeCount," players attended"]}),t.jsx("div",{className:"card-actions justify-end",children:t.jsx(M,{to:`/events/${e.id}`,className:"btn btn-secondary btn-sm",children:"View"})})]})},e.id))}),C>1&&t.jsxs("div",{className:"flex justify-center mt-6 gap-2",children:[t.jsx("button",{className:"btn btn-sm",disabled:y===1,onClick:()=>j(e=>e-1),children:"â—€ Prev"}),t.jsxs("span",{className:"btn btn-sm btn-disabled",children:["Page ",y," of ",C]}),t.jsx("button",{className:"btn btn-sm",disabled:y===C,onClick:()=>j(e=>e+1),children:"Next â–¶"})]})]})}export{J as default};
