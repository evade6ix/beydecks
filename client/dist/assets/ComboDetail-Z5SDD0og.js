import{a as k,r,j as e,H as E,L as S}from"./index-yNFFM0-c.js";const L="https://beydecks-production.up.railway.app/api",i=c=>c.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9\-]/g,"");function B(){const{slug:c}=k(),[u,w]=r.useState([]),[D,T]=r.useState(!0),[d,m]=r.useState(1),[h,N]=r.useState("All"),x=5;if(!c)return e.jsx("div",{children:"No combo found"});const l=decodeURIComponent(c).toLowerCase().split("-"),p=i(l[l.length-1]),j=i(l.slice(l.length-3,l.length-1).join("-")),b=i(l.slice(0,l.length-3).join("-"));r.useEffect(()=>{fetch(`${L}/events`).then(t=>t.json()).then(w).catch(t=>console.error("❌ Failed to fetch events:",t)).finally(()=>T(!1))},[]);const $=t=>i(t.blade)===b&&i(t.ratchet)===j&&i(t.bit)===p,f=r.useMemo(()=>{const t=new Date;let o=[...u];if(h==="This Week"){const s=new Date(t);s.setDate(t.getDate()-t.getDay()),s.setHours(0,0,0,0),o=o.filter(a=>new Date(a.startTime)>=s)}if(h==="This Month"){const s=new Date(t.getFullYear(),t.getMonth(),1);o=o.filter(a=>new Date(a.startTime)>=s)}if(h==="This Year"){const s=new Date(t.getFullYear(),0,1);o=o.filter(a=>new Date(a.startTime)>=s)}const v=[];for(const s of o){if(!s.topCut)continue;let a=0;for(const C of s.topCut)for(const M of C.combos)$(M)&&a++;a>0&&v.push({eventId:String(s.id),eventTitle:s.title,date:s.startTime,store:s.store,count:a})}return v.sort((s,a)=>new Date(a.date).getTime()-new Date(s.date).getTime())},[u,b,j,p,h]),g=Math.ceil(f.length/x),y=f.slice((d-1)*x,d*x),n={blade:b.replace(/-/g," "),ratchet:j.replace(/-/g," "),bit:p.replace(/-/g," ")};return e.jsxs(e.Fragment,{children:[e.jsxs(E,{children:[e.jsx("title",{children:`${n.blade} / ${n.ratchet} / ${n.bit} — Combo Stats | Meta Beys`}),e.jsx("meta",{name:"description",content:`Explore tournament appearances and event data for the ${n.blade} / ${n.ratchet} / ${n.bit} Beyblade X combo.`}),e.jsx("meta",{property:"og:title",content:`${n.blade} / ${n.ratchet} / ${n.bit} — Meta Beys`}),e.jsx("meta",{property:"og:description",content:`View how the ${n.blade}, ${n.ratchet}, and ${n.bit} combo performs in competitive Beyblade X tournaments.`}),e.jsx("meta",{property:"og:url",content:`https://www.metabeys.com/combo/${c}`}),e.jsx("meta",{name:"robots",content:"index, follow"})]}),e.jsxs("div",{className:"p-6 max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Combo Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Blade:"})," ",n.blade]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Ratchet:"})," ",n.ratchet]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Bit:"})," ",n.bit]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mt-6 mb-2",children:"Used In Events"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mr-2 font-semibold",children:"Timeframe:"}),e.jsxs("select",{className:"select select-bordered",value:h,onChange:t=>{m(1),N(t.target.value)},children:[e.jsx("option",{children:"All"}),e.jsx("option",{children:"This Week"}),e.jsx("option",{children:"This Month"}),e.jsx("option",{children:"This Year"})]})]}),D?e.jsx("p",{children:"Loading events..."}):f.length===0?e.jsx("p",{className:"text-error",children:"No events found with this combo."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"table w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Event"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Store"}),e.jsx("th",{children:"Total Uses"})]})}),e.jsx("tbody",{children:y.map((t,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(S,{to:`/events/${t.eventId}`,className:"link link-hover",children:t.eventTitle})}),e.jsx("td",{children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{children:t.store}),e.jsx("td",{children:t.count})]},o))})]}),e.jsxs("div",{className:"mt-4 flex justify-center items-center gap-3",children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>m(t=>Math.max(1,t-1)),disabled:d===1,children:"Prev"}),e.jsxs("span",{children:["Page ",d," of ",g]}),e.jsx("button",{className:"btn btn-sm",onClick:()=>m(t=>Math.min(g,t+1)),disabled:d===g,children:"Next"})]})]})]})]})]})}export{B as default};
