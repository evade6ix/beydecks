import{d as w,j as e,r as n}from"./index-yNFFM0-c.js";const g="https://beydecks-production.up.railway.app/api";function A(){const{user:l,isAuthenticated:f,loading:y}=w();if(y)return e.jsx("div",{className:"p-6 text-white",children:"Checking login status..."});if(!f)return e.jsxs("div",{className:"p-6 text-white text-center max-w-xl mx-auto mt-12 space-y-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"ðŸ”’ Tournament Lab Locked"}),e.jsx("p",{className:"text-sm text-gray-400",children:"You must be logged in to use Tournament Lab and analyze your combos."}),e.jsx("a",{href:"/user-auth",className:"inline-block bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2 rounded",children:"Log In to Continue"})]});const[r,u]=n.useState([{blade:"",ratchet:"",bit:""},{blade:"",ratchet:"",bit:""},{blade:"",ratchet:"",bit:""}]),[a,m]=n.useState(1),[c,j]=n.useState([]),[h,p]=n.useState(!1),[x,C]=n.useState(null),i=n.useRef(null);n.useEffect(()=>{l!=null&&l.id&&fetch(`${g}/prep-decks/user/${l.id}`).then(t=>t.json()).then(t=>{t&&t.combos&&C(t)}).catch(()=>null)},[l]),n.useEffect(()=>{c.length>0&&i.current&&i.current.scrollIntoView({behavior:"smooth"})},[c]);const d=(t,s,o)=>{const b=[...r];b[t]={...b[t],[s]:o},u(b)},v=()=>{if(a>1){m(a-1);const t=[...r];t[a-1]={blade:"",ratchet:"",bit:""},u(t)}},N=async()=>{const t=r.slice(0,a).filter(s=>s.blade&&s.ratchet&&s.bit);if(t.length===0)return alert("Please enter at least one full combo.");p(!0);try{const o=await(await fetch(`${g}/prep-decks/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({combos:t})})).json();j(o.analysis)}catch(s){console.error(s),alert("Error analyzing combos")}finally{p(!1)}};return e.jsxs("div",{className:"p-6 text-white max-w-3xl mx-auto space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Tournament Lab"}),e.jsx("p",{children:"Prep your deck by entering up to 3 combos below."}),x&&e.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-4 rounded",children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Previous Prep Deck"}),x.combos.map((t,s)=>e.jsxs("p",{className:"text-sm",children:[t.blade," / ",t.ratchet," / ",t.bit]},s))]}),r.slice(0,a).map((t,s)=>e.jsxs("div",{className:"space-y-2 border border-gray-700 p-4 rounded-lg",children:[e.jsxs("h2",{className:"font-semibold",children:["Combo ",s+1]}),e.jsx("input",{type:"text",className:"w-full p-2 bg-black border border-gray-600 rounded",placeholder:"Blade",value:t.blade,onChange:o=>d(s,"blade",o.target.value)}),e.jsx("input",{type:"text",className:"w-full p-2 bg-black border border-gray-600 rounded",placeholder:"Ratchet",value:t.ratchet,onChange:o=>d(s,"ratchet",o.target.value)}),e.jsx("input",{type:"text",className:"w-full p-2 bg-black border border-gray-600 rounded",placeholder:"Bit",value:t.bit,onChange:o=>d(s,"bit",o.target.value)}),a>1&&s===a-1&&e.jsx("button",{onClick:v,className:"text-red-400 text-sm underline mt-2",children:"Remove Combo"})]},s)),a<3&&e.jsx("button",{onClick:()=>m(a+1),className:"text-blue-400 text-sm underline",children:"+ Add Combo"}),e.jsx("div",{className:"flex space-x-4",children:e.jsx("button",{onClick:N,className:"bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded font-semibold",disabled:h,children:h?"Analyzing...":"Analyze Combos"})}),c.length>0&&e.jsxs("div",{ref:i,className:"space-y-4 mt-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Top Cut Stats (Global)"}),c.map((t,s)=>e.jsxs("div",{className:"bg-gray-800 p-4 rounded space-y-2",children:[e.jsxs("p",{className:"font-semibold",children:["Your Combo: ",t.submittedCombo.blade," / ",t.submittedCombo.ratchet," / ",t.submittedCombo.bit]}),e.jsxs("p",{children:["Top Cut Appearances: ",e.jsx("strong",{children:t.topCutAppearances})]}),e.jsxs("p",{children:["Unique Events: ",e.jsx("strong",{children:t.uniqueEvents})]}),e.jsxs("p",{children:["Most Recent Appearance: ",e.jsx("strong",{children:t.mostRecentAppearance||"N/A"})]}),e.jsxs("p",{children:["First Seen: ",e.jsx("strong",{children:t.firstSeen||"N/A"})]})]},s))]})]})}export{A as default};
